function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){$("#blah").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}function loadParseItem(e,t){var a=new Image;$("#first-column").height()>$("#second-column").height()?$("#second-column").append(e[t]):$("#first-column").append(e[t]),document.getElementsByClassName("img-last-stream")[0]?(a.src=document.getElementsByClassName("img-last-stream")[0].getAttribute("src"),a.onload=function(a){e.length>=t&&loadParseItem(e,t+1),$(".img-last-stream").removeClass("img-last-stream")}):e.length>=t&&loadParseItem(e,t+1)}$(document).ready(function(){$(document).on("click",".parser__close",function(){return $(".single-parser-element").slideToggle("slow"),!1}),$(document).on("click",".wrap-item-feedback",function(){$("#modal-company-rew").find(".thumb").children("img").attr("src",""),$("#modal-company-rew").find(".thumb").children("span").text("");var e=$(this).find(".name").text(),t=$(this).find(".thumb").children(),a=$(this).find(".rew-title").text();t.is("img")?$("#modal-company-rew").find(".thumb").children("img").attr("src",t.attr("src")):$("#modal-company-rew").find(".thumb").children("span").text(t.text());var r=$(this).find(".rew-descr").text();return $("#modal-company-rew").find(".name").text(e),$("#modal-company-rew").find(".rew-descr").text(r),$("#modal-company-rew").find("h2.title").text(a),$("#black-overlay").fadeIn(400,function(){$("#modal-company-rew").css("display","block").animate({opacity:1},200)}),!1}),$(document).on("click","#black-overlay",function(){$("#black-overlay").fadeIn(400,function(){$("#modal-company-rew").css("display","none").animate({opacity:1},200)})}),$(document).on("click",".ask, .ask-question",function(){event.preventDefault(),$("#black-overlay").fadeIn(400,function(){$("#modal-faq").css("display","block").animate({opacity:1},200)})}),$(document).on("click","#black-overlay",function(){$("#black-overlay").fadeIn(400,function(){$("#modal-faq").css("display","none").animate({opacity:1},200)})}),$(document).on("click",".likes",function(){var e=$(this).attr("csrf-token"),t=$(this);return $.ajax({url:"/likes/like",type:"POST",data:{post_id:$(this).attr("data-id"),post_type:$(this).attr("data-type"),_csrf:e},success:function(e){t.children(".like-counter").html(e),t.hasClass("active")?t.removeClass("active"):t.addClass("active")}}),!1}),$(document).on("change","#company-tariff_id",function(){$(".set-services-of-tariff").html(""),4==$(this).val()&&$.ajax({url:"/secure/company/company/get-services",type:"get",success:function(e){$(".set-services-of-tariff").append(e)}})}),$(document).on("click",".search-consulting-post",function(){var e=$(this).prev().val();$.ajax({url:"/consulting/consulting/search-post",type:"get",data:{q:e},success:function(e){$(".laws").html(""),$(".laws").append(e)}})}),$(document).on("click",".show-more-news-js",function(){var e=$(this).attr("csrf-token");return $.ajax({url:"/news/news/more-news",type:"POST",data:{_csrf:e,offset:$(this).attr("data-offset")},success:function(e){$(".show-more-news-js").attr("data-offset",parseInt($(".show-more-news-js").attr("data-offset"))+16),$(".home-content__wrap_subscribe").before(e)}}),!1}),$(document).on("click",".show-more-stream",function(e){var t=$(this).attr("csrf-token"),a=$(this).attr("data-step"),r=$(this).attr("data-dt");return $.ajax({url:"/stream/default/load-more",type:"POST",data:{_csrf:t,step:a,dt_add:r},success:function(e){$(".business__sidebar").removeClass("absolute"),$(".business__sidebar").addClass("fixed");var t=JSON.parse(e);$(".show-more-stream").attr("data-step",parseInt($(".show-more-stream").attr("data-step"))+1),loadParseItem(t.render,0),t.count||($(".show-more-stream").hide(),$(".counter-stream-new").text("0"))}}),!1}),$(document).on("click",".send-comment",function(){var e=$(this).prev().val(),t=$(".show-more-stream").attr("csrf-token");return $.ajax({url:"/stream/default/set-comment",type:"POST",data:{_csrf:t,message:e},success:function(e){$(".send-comment").prev().val(""),$(".coments-block-item").append(e),$(".count-comments").text(Number($(".count-comments").text())+1),$(".count-comments").addClass("show-comments"),$(".coments-block-item").css("display","block")},error:function(){$(".coments-block-item").append('<p class="text-danger">Произошла ошибка</p>')}}),!1}),$(document).on("click",".show-more-category-news-js",function(){var e=$(this).attr("csrf-token");return $.ajax({url:"/news/news/more-category-news",type:"POST",data:{_csrf:e,offset:$(this).attr("data-offset"),category:$(this).attr("data-category")},success:function(e){$(".show-more-category-news-js").attr("data-offset",parseInt($(".show-more-category-news-js").attr("data-offset"))+16),$(".home-content__wrap_subscribe").before(e)}}),!1}),$(".datepicker-here").datepicker({dateFormat:"yyyy-mm-dd",onSelect:function(e,t,a){console.log(e),window.location.href="/news/archive/"+e}}),$("#poster_archive").datepicker({dateFormat:"yyyy-mm-dd",onSelect:function(e,t,a){console.log(e),window.location.href="/poster/archive/"+e}}),$(document).on("click",".load-more-popular-poster-w",function(){var e=$(this).attr("data-page");return $(this).attr("data-page",+e+1),$.ajax({url:"/poster/default/more-poster",type:"POST",data:{_csrf:$(this).attr("csrf-token"),page:$(this).attr("data-page"),limit:$(this).attr("data-limit"),count:$(this).attr("data-count-post")},success:function(e){var t=JSON.parse(e);$(".afisha-events__wrap").append(t.html),1===t.last&&$(".load-more-popular-poster-w").remove()}}),!1}),$(document).on("click",".addCategAddNewsUser",function(){$(".error_cat").text("");var e="",t=$(".selectCateg"),a=t[t.length-1];return $(".selectCateg").each(function(r,s){e+=$(this).val()+",",console.log(e),r<t.length&&""!=$(a).val()&&$(this).addClass("disabled")}),""==$(a).val()?($(".error_cat").text("Выберите категорию"),!1):($.ajax({url:"/ajax/ajax/add-category-select",type:"POST",data:{_csrf:$("input[name='_csrf']").val(),catId:e},success:function(e){$(".addSelectCateg").before(e)}}),!1)}),$(document).on("click",".delselectCateg",function(){$(this).closest(".cabinet__add-company-form--hover-wrapper").remove();var e=$(".selectCateg");console.log("Selects variable:",e);var t=e[e.length-1];$(t).removeClass("disabled")}),$(document).on("click",".delNewsSelectCateg",function(){$(this).closest(".cabinet__add-company-form--hover-wrapper").remove();var e=$(".selectCateg");e[e.length-1];return $(".selectCateg:last").removeClass("disabled"),$(".selectCateg").each(function(e,t){$(this).val()+","}),!1}),$("#news-photo").change(function(){readURL(this)}),$("#profile-avatar").change(function(){readURL(this)}),$("#company-photo").change(function(){readURL(this)}),$("#poster-photo").change(function(){readURL(this)}),$("#stock-photo").change(function(){readURL(this)}),$(document).on("change","#categ_company",function(){var e=$("#categ_company").val();console.log(e),$.ajax({url:"/ajax/ajax/add-parent-category",type:"POST",data:{_csrf:$("input[name='_csrf']").val(),catId:e},success:function(e){$(".addParentCategory").html(e)}})}),$(document).on("click",".services-select",function(){var e=0,t=0,a="",r=$(".servise-individual-order").attr("data-href");$(".services-select").each(function(){$(this).prop("checked")&&(e+=parseInt($(this).attr("price")),t++,a+=$(this).attr("service-id")+",")}),$(".summ-select-services").html(e),$(".count-select-services").html(t),r+="&price="+e+"&servicesId="+a,$(".servise-individual-order").attr("href",r)}),$(document).on("click","#send-error-site",function(){$(".error-modal-name-error").text(""),$(".error-modal-email-error").text(""),$(".error-modal-message-error").text("");var e=$("#error-user-message").val();if(document.getElementById("error-user-name")&&document.getElementById("error-user-email")){var t=$("#error-user-name").val();(a=$("#error-user-email").val())||$(".error-modal-email-error").css("color","red").text("Введите email"),t||$(".error-modal-name-error").css("color","red").text("Введите Имя")}else{t=0;var a=0}return e||$(".error-modal-message-error").css("color","red").text("Введите сообщение"),""!=e&&""!==t&&""!==a&&$.ajax({url:"/ajax/ajax/send-error-msg",type:"POST",data:{_csrf:$("input[name='_csrf']").val(),url:$("input[name='url']").val(),user_id:$("input[name='user_id']").val(),name:t,email:a,text:e},success:function(e){1==e?$("#error-message").html('<h3 class="modal-callback__title">Спасибо. Мы исправим все в ближайшее время</h3>'):$("#error-message").html('<h3 class="modal-callback__title">Ваше сообщение об ошибке не отправлено.</h3>')}}),!1}),$(document).on("click","#add-review",function(){var e=$(this).attr("data-id"),t=$(this).attr("data-name");$("input[name='company_name']").val(t),$("input[name='company_id']").val(e)}),$(document).on("click","#modal-review-submit",function(e){var t=$("textarea[name='text_feedback']").val(),a=$("input[name='company_id']").val(),r=$("input[name='company_name']").val();return""!=t?(e.preventDefault(),$.ajax({type:"POST",url:"/company/default/feedback/",data:{_csrf:$("input[name='_csrf']").val(),id:a,name:r,text:t},success:function(e){$("#modal-review").animate({opacity:0},200,function(){$(this).css("display","none"),$("#modal-review-success").css("display","block").animate({opacity:1},200)})}}),!1):($(".feedback_error").text("Вы не оставили отзыв"),!1)})});